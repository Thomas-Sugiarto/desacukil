{% extends "base/base.html" %}

{% block title %}{{ site_settings.site_name or 'Portal Desa Digital' }} - Beranda{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1>Selamat Datang di {{ site_settings.site_name or 'Portal Desa Digital' }}</h1>
                <p class="lead">{{ site_settings.site_description or 'Sistem Informasi dan Layanan Desa yang Modern dan Terpercaya' }}</p>
                <a href="#content" class="btn btn-light btn-lg">Jelajahi Informasi</a>
            </div>
            <div class="col-lg-4 text-center">
                <i class="bi bi-house-heart display-1"></i>
            </div>
        </div>
    </div>
</section>

<!-- Featured Content -->
<section id="content" class="py-5">
    <div class="container">
        <h2 class="section-title text-center mb-5">Informasi Terbaru</h2>
        
        {% if featured_content %}
        <div class="row">
            {% for content in featured_content %}
            <div class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100">
                    {% if content.cover_image %}
                    <img src="{{ get_file_url(content.cover_image) }}" class="card-img-top" alt="{{ content.title }}" style="height: 200px; object-fit: cover;">
                    {% elif content.youtube_url %}
                    <div class="card-img-top position-relative" style="height: 200px;">
                        <iframe src="{{ get_youtube_embed_url(content.youtube_url) }}" 
                                class="w-100 h-100" 
                                frameborder="0" 
                                allowfullscreen>
                        </iframe>
                    </div>
                    {% else %}
                    <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
                        <i class="bi bi-file-text display-4 text-muted"></i>
                    </div>
                    {% endif %}
                    
                    <div class="card-body d-flex flex-column">
                        {% if content.category %}
                        <span class="category-badge mb-2" style="background-color: {{ content.category.color }};">
                            {{ content.category.name }}
                        </span>
                        {% endif %}
                        
                        <h5 class="card-title">{{ content.title }}</h5>
                        
                        {% if content.excerpt %}
                        <p class="card-text">{{ content.excerpt|truncate_words(20) }}</p>
                        {% else %}
                        <p class="card-text">{{ content.content|striptags|truncate_words(20) }}</p>
                        {% endif %}
                        
                        <div class="mt-auto">
                            <small class="text-muted">
                                <i class="bi bi-calendar3 me-1"></i>
                                {{ content.published_at|datetime }}
                            </small>
                            <div class="mt-2">
                                <a href="{{ url_for('public.content_detail', slug=content.slug) }}" class="btn btn-outline-primary btn-sm">
                                    Baca Selengkapnya
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-5">
            <i class="bi bi-info-circle display-4 text-muted"></i>
            <p class="text-muted mt-3">Belum ada konten yang dipublikasikan.</p>
        </div>
        {% endif %}
    </div>
</section>

<!-- Content by Categories -->
{% for category in categories %}
{% if content_by_category[category.slug] %}
<section class="py-4 bg-light">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="section-title mb-0">{{ category.name }}</h3>
            <a href="{{ url_for('public.category_content', slug=category.slug) }}" class="btn btn-outline-primary btn-sm">
                Lihat Semua
            </a>
        </div>
        
        <div class="row">
            {% for content in content_by_category[category.slug] %}
            <div class="col-md-4 mb-3">
                <div class="card h-100">
                    {% if content.cover_image %}
                    <img src="{{ get_file_url(content.cover_image) }}" class="card-img-top" alt="{{ content.title }}" style="height: 150px; object-fit: cover;">
                    {% elif content.youtube_url %}
                    <div class="card-img-top position-relative" style="height: 150px;">
                        <iframe src="{{ get_youtube_embed_url(content.youtube_url) }}" 
                                class="w-100 h-100" 
                                frameborder="0" 
                                allowfullscreen>
                        </iframe>
                    </div>
                    {% endif %}
                    <div class="card-body">
                        <h6 class="card-title">{{ content.title }}</h6>
                        <p class="card-text small">{{ content.excerpt|truncate_words(15) or content.content|striptags|truncate_words(15) }}</p>
                        <small class="text-muted">{{ content.published_at|datetime }}</small>
                        <div class="mt-2">
                            <a href="{{ url_for('public.content_detail', slug=content.slug) }}" class="btn btn-sm btn-outline-secondary">
                                Baca
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}
{% endfor %}

<!-- Quick Info Section -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="bi bi-geo-alt display-4 text-primary mb-3"></i>
                        <h5 class="card-title">Alamat Kantor</h5>
                        <p class="card-text">{{ site_settings.address or 'Jl. Raya Desa No. 123' }}</p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="bi bi-telephone display-4 text-success mb-3"></i>
                        <h5 class="card-title">Kontak</h5>
                        <p class="card-text">{{ site_settings.contact_phone or '021-12345678' }}</p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="bi bi-envelope display-4 text-info mb-3"></i>
                        <h5 class="card-title">Email</h5>
                        <p class="card-text">{{ site_settings.contact_email or 'info@desa.go.id' }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}